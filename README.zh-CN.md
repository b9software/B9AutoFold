# B9AutoFold

一个轻量的 VS Code 扩展，在你打开文件时自动折叠较深层的代码块，让主要结构尽量显示在一屏（约 40 行）内。这款插件最初是给自己手写代码提效的，如今也是 Vibe Coding 中审阅代码的得力助手。

[English](./README.md) | 中文说明

## 快速上手

- 从应用商店安装 B9AutoFold
- 打开任意文件，插件会自动进行折叠以展示高层结构
- 如需重新折叠，可在命令面板运行「B9AutoFold: Refold Current File」

## 特性

- 开箱即用，无需配置
- 审查 AI 生成代码的好帮手：自动保持未提交的变更（git diff）展开。当 AI 修改代码后，你只需关注变更部分，其余无关代码保持折叠，提升 Review 效率
- 基于编辑器的文档符号（Outline）智能规划折叠，支持任何提供符号的语言
- 当符号不可用时，自动回退到「折叠层级 2」
- 尊重当前选择：会尽量避免折叠你已选择的区域
- 对短文件（约 40 行以内）不进行折叠，避免干扰
- 针对测试文件进行特殊处理：例如保留 `describe` 块可见，在空间紧张时折叠具体用例

## 命令

- B9AutoFold: Refold Current File —— 先展开全部，再为当前文件重新应用折叠计划
- B9AutoFold: Export Symbols for Debugging —— 将符号信息与折叠计划复制到剪贴板，便于排查折叠问题

## 配置

B9AutoFold 开箱即用，但也提供了针对未提交更改行为的配置：

- `B9AutoFold.uncommittedChanges.enable`: 启用/禁用「不折叠未提交更改」（默认：`true`）。

## 工作原理

- 插件读取文档符号，自下而上计算折叠方案，目标将可见行数压到约 40 行
- 若语言不提供符号，则回退到 VS Code 的「折叠层级 2」
- 会避免折叠与当前选择区域相交的符号范围
- 仅在文件打开/激活时触发，或手动执行重新折叠命令时触发

## 限制与说明

- 在支持文档符号（Outline）的语言中效果最佳；其它情况采用简单的层级折叠
- 重新应用折叠时可能会先「展开全部」以确保结果干净可控
- 超大文件或特殊的符号提供器可能导致折叠较为保守

## 隐私与性能

- 不进行任何联网或数据上传，所有逻辑在本地通过 VS Code API 完成
- 对性能影响极小：仅在打开/激活文件与手动重新折叠时进行计算

## 意见反馈

折叠效果不理想？执行「B9AutoFold: Export Symbols for Debugging」，将拷贝的内容和你的期望在此提交：https://github.com/b9software/B9AutoFold/issues/new
